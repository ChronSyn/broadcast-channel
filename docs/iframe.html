<html>

<head>
    <script src="./broadcast-channel.browserify.js"></script>
</head>

<body id="body">
    <div id="messages"></div>
</body>

<script>
    var channel = new window.BroadcastChannel2('foobar');
    var msgContainer = document.getElementById('messages');
    channel.onmessage = function(msg) {
        console.log('iframe: recieved message(' + msg.step + '): ' + JSON.stringify(msg));

        msgContainer.innerHTML += JSON.stringify(msg) + '</br>';

        if (!msg.answer) {
            console.log('iframe: answer back');
            channel.postMessage({
                answer: true,
                from: 'iframe',
                original: msg
            });
        }
    };
</script>

</html>
